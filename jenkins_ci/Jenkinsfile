pipeline { 
    agent {
        label 'docker'
    } 
    stages {
        stage('Structure of directories'){
            steps {
                sh 'tree \$PWD'
                sh 'pip install -r playbook/test-requirements.txt'
                sh 'pip install -r playbook/roles/elasticsearch-role/test-requirements.txt'
            }
        }
        stage('Molecule test'){
            steps {
                dir('playbook/roles/elasticsearch-role') {
                    sh 'molecule test'
                }                
            }                        
        }                
    }
}